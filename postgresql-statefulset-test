oc project openshift

oc create -f postgresql-statefulset-template.json 

oc create -f postgresql-statefulset-template-dynamic.json 

oadm new-project postgresql-cluster --display-name='PostgreSQL Cluster' --description='PostgreSQL Cluster using StatefulSets' --node-selector='region=dev'

oc project postgresql-cluster

oadm policy add-role-to-user edit -z default

oc new-app postgresql-statefulset
#or
#oc new-app postgresql-statefulset-dynamic

#oc new-app postgresql-statefulset -p KEY1=VALUE1 -p KEY2=VALUE2

--------------------------------------------------------------------------------------------------------

oc rsh pgset-0

psql -U postgres postgres -c 'table pg_stat_replication'

psql -d sampledb -U userxyz #lowercase

CREATE TABLE customer (
  CustomerID varchar(12) NOT NULL,
  FIRSTNAME varchar(25) NOT NULL,
  LASTNAME varchar(25) NOT NULL,
  MIDDLENAME varchar(15) DEFAULT NULL,
  StreetAddress varchar(50) NOT NULL,
  StreetAddress2 varchar(50) DEFAULT NULL,
  CITY varchar(25) NOT NULL,
  StateProvince varchar(25) DEFAULT NULL,
  POSTALCODE varchar(15) NOT NULL,
  COUNTRY varchar(10) DEFAULT NULL,
  PhoneNumber varchar(30) DEFAULT NULL,
  PRIMARY KEY (CustomerID)
);

INSERT INTO customer VALUES ('CST01010','Ian','Hardy','Thomas','120 Hanover Square',NULL,'London',NULL,'WA1 1DP','UK','(171)555-8181'),('CST01011','Elizabeth','Ashworth','Brown','1817 Chancelor Road',NULL,'London',NULL,'OX15 4NB','UK','(171)555-1870'),('CST01012','Alfred','Teagarden','Lloyd','12 Berkeley Gardens','Flat 25','Westminster',NULL,'SW7 1EZ','UK','(199)555-1720'),('CST01013','Amelia','Lindberg','Anne','95 Wadhurst Road',NULL,'Farnborough',NULL,'GU14 4LT','UK','(186)555-6709'),('CST01014','Jack','Crowther','Devon','450 Queensbridge Lane',NULL,'Scorborough',NULL,'YO2 5SC','UK','(165)555-5402'),('CST01016','Jean','LaRue','Claude','54 Rue St. Laurent','Apartment 66','Montreal','Quebec','H1J 1C3','Canada','(514)555-9120'),('CST01017','Alejandro','Carmino',NULL,'Gran Via, 1',NULL,'Madrid',NULL,'28011','Spain','(91)555-6225 '),('CST01018','Edwardo','Salvedore','Diego','Rambla de Cataluna, 58',NULL,'Barcelona',NULL,'08022','Spain','(93)555-2367 '),('CST01023','Marie','Bertrande',NULL,'78, rue de la Maison',NULL,'Paris',NULL,'75012','France','(1)45.23.68.89'),('CST01024','Herbert','MeCustomerIDer','Charles','Obere Street, 92',NULL,'Berlin',NULL,'12210','Germany','0300-076548'),('CST01025','Hanna','Rogers','Nancy','3500 Drouillard Road',NULL,'Windsor','Ontario','M5C 2V9','Canada','(416)555-9876'),('CST01026','Veronique','Treillon','Carine','705, boulevard Tigre',NULL,'Lyon',NULL,'69005','France','78.56.43.18'),('CST01028','Pierre','Henriotte','Claude','15, rue Alsace-Lorraine',NULL,'Toulouse',NULL,'31010','France','61.77.68.18'),('CST01029','Laurence','Perrier','Charles','35, rue Royale',NULL,'Marseille',NULL,'13010','France','91.24.45.67'),('CST01030','Sven','Mueller','Phillip','Magazinweg 67',NULL,'Frankfurt',NULL,'60550','Germany','069-0245885'),('CST01031','Daniel','LaBlanche',NULL,'88, place Provincial',NULL,'Paris',NULL,'75014','France','(1)47.55.65.15'),('CST01032','Paul','Zimmerman','David','2536 Oaklawn Avenue',NULL,'Vancouver','British Columbia','V3F 2K1','Canada','(604)555-2729'),('CST01033','Alexander','Franken','Horst','Berliner Platz 85',NULL,'Munich',NULL,'80806','Germany','089-0877435');

select count(*) from customer;

----------------------------------------------------------------------------------------------------------

oc rsh pgset-1

replica is read only 

psql -d sampledb -U userxyz #lowercase

insert should fail

select count(*) from customer; should return 18 records 


